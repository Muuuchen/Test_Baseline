WARNING: python3 and any of its children processes will be profiled.

/root/miniconda3/envs/pytorch/lib/python3.9/site-packages/torch/nn/modules/module.py:1501: UserWarning: operator() profile_node %690 : bool = prim::profile_ivalue(%training.37)
 does not have profile information (Triggered internally at ../third_party/nvfuser/csrc/graph_fuser.cpp:104.)
  return forward_call(*args, **kwargs)
/root/miniconda3/envs/pytorch/lib/python3.9/site-packages/torch/onnx/utils.py:825: UserWarning: no signature found for <torch.ScriptMethod object at 0x7efd5f2b7310>, skipping _decide_input_format
  warnings.warn(f"{e}, skipping _decide_input_format")
run model.forward_real [1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1]
[31m100 iters, min = 16.2630 ms, max = 18.2369 ms, avg = 16.9631 ms[m
============= Diagnostic Run torch.onnx.export version 2.0.1+cu118 =============
verbose: False, log level: Level.ERROR
======================= 0 NONE 0 NOTE 0 WARNING 0 ERROR ========================

Generating '/tmp/nsys-report-0404.qdstrm'
[1/7] [0%                          ] report1.nsys-rep[1/7] [0%                          ] report1.nsys-rep[1/7] [8%                          ] report1.nsys-rep[1/7] [7%                          ] report1.nsys-rep[1/7] [6%                          ] report1.nsys-rep[1/7] [5%                          ] report1.nsys-rep[1/7] [10%                         ] report1.nsys-rep[1/7] [9%                          ] report1.nsys-rep[1/7] [8%                          ] report1.nsys-rep[1/7] [7%                          ] report1.nsys-rep[1/7] [11%                         ] report1.nsys-rep[1/7] [10%                         ] report1.nsys-rep[1/7] [9%                          ] report1.nsys-rep[1/7] [8%                          ] report1.nsys-rep[1/7] [7%                          ] report1.nsys-rep[1/7] [6%                          ] report1.nsys-rep[1/7] [5%                          ] report1.nsys-rep[1/7] [5%                          ] report1.nsys-rep[1/7] [7%                          ] report1.nsys-rep[1/7] [8%                          ] report1.nsys-rep[1/7] [9%                          ] report1.nsys-rep[1/7] [10%                         ] report1.nsys-rep[1/7] [11%                         ] report1.nsys-rep[1/7] [12%                         ] report1.nsys-rep[1/7] [14%                         ] report1.nsys-rep[1/7] [=15%                        ] report1.nsys-rep[1/7] [=16%                        ] report1.nsys-rep[1/7] [=17%                        ] report1.nsys-rep[1/7] [==18%                       ] report1.nsys-rep[1/7] [==19%                       ] report1.nsys-rep[1/7] [==20%                       ] report1.nsys-rep[1/7] [==21%                       ] report1.nsys-rep[1/7] [===22%                      ] report1.nsys-rep[1/7] [===23%                      ] report1.nsys-rep[1/7] [===24%                      ] report1.nsys-rep[1/7] [====25%                     ] report1.nsys-rep[1/7] [====26%                     ] report1.nsys-rep[1/7] [====27%                     ] report1.nsys-rep[1/7] [====28%                     ] report1.nsys-rep[1/7] [=====29%                    ] report1.nsys-rep[1/7] [=====30%                    ] report1.nsys-rep[1/7] [=====31%                    ] report1.nsys-rep[1/7] [=====32%                    ] report1.nsys-rep[1/7] [======33%                   ] report1.nsys-rep[1/7] [======34%                   ] report1.nsys-rep[1/7] [======35%                   ] report1.nsys-rep[1/7] [=======36%                  ] report1.nsys-rep[1/7] [=======37%                  ] report1.nsys-rep[1/7] [=======38%                  ] report1.nsys-rep[1/7] [=======39%                  ] report1.nsys-rep[1/7] [========40%                 ] report1.nsys-rep[1/7] [========41%                 ] report1.nsys-rep[1/7] [========42%                 ] report1.nsys-rep[1/7] [=========43%                ] report1.nsys-rep[1/7] [=========44%                ] report1.nsys-rep[1/7] [=========45%                ] report1.nsys-rep[1/7] [=========46%                ] report1.nsys-rep[1/7] [==========47%               ] report1.nsys-rep[1/7] [==========48%               ] report1.nsys-rep[1/7] [==========49%               ] report1.nsys-rep[1/7] [===========50%              ] report1.nsys-rep[1/7] [===========51%              ] report1.nsys-rep[1/7] [===========52%              ] report1.nsys-rep[1/7] [===========53%              ] report1.nsys-rep[1/7] [============54%             ] report1.nsys-rep[1/7] [============55%             ] report1.nsys-rep[1/7] [============57%             ] report1.nsys-rep[1/7] [=============58%            ] report1.nsys-rep[1/7] [=============59%            ] report1.nsys-rep[1/7] [=============60%            ] report1.nsys-rep[1/7] [==============61%           ] report1.nsys-rep[1/7] [==============62%           ] report1.nsys-rep[1/7] [==============63%           ] report1.nsys-rep[1/7] [==============64%           ] report1.nsys-rep[1/7] [===============65%          ] report1.nsys-rep[1/7] [==================76%       ] report1.nsys-rep[1/7] [========================100%] report1.nsys-rep[1/7] [========================100%] report1.nsys-rep
[2/7] [0%                          ] report1.sqlite[2/7] [1%                          ] report1.sqlite[2/7] [2%                          ] report1.sqlite[2/7] [3%                          ] report1.sqlite[2/7] [4%                          ] report1.sqlite[2/7] [5%                          ] report1.sqlite[2/7] [6%                          ] report1.sqlite[2/7] [7%                          ] report1.sqlite[2/7] [8%                          ] report1.sqlite[2/7] [9%                          ] report1.sqlite[2/7] [10%                         ] report1.sqlite[2/7] [11%                         ] report1.sqlite[2/7] [12%                         ] report1.sqlite[2/7] [13%                         ] report1.sqlite[2/7] [14%                         ] report1.sqlite[2/7] [=15%                        ] report1.sqlite[2/7] [=16%                        ] report1.sqlite[2/7] [=17%                        ] report1.sqlite[2/7] [==18%                       ] report1.sqlite[2/7] [==19%                       ] report1.sqlite[2/7] [==20%                       ] report1.sqlite[2/7] [==21%                       ] report1.sqlite[2/7] [===22%                      ] report1.sqlite[2/7] [===23%                      ] report1.sqlite[2/7] [===24%                      ] report1.sqlite[2/7] [====25%                     ] report1.sqlite[2/7] [====26%                     ] report1.sqlite[2/7] [====27%                     ] report1.sqlite[2/7] [====28%                     ] report1.sqlite[2/7] [=====29%                    ] report1.sqlite[2/7] [=====30%                    ] report1.sqlite[2/7] [=====31%                    ] report1.sqlite[2/7] [=====32%                    ] report1.sqlite[2/7] [======33%                   ] report1.sqlite[2/7] [======34%                   ] report1.sqlite[2/7] [======35%                   ] report1.sqlite[2/7] [=======36%                  ] report1.sqlite[2/7] [=======37%                  ] report1.sqlite[2/7] [=======38%                  ] report1.sqlite[2/7] [=======39%                  ] report1.sqlite[2/7] [========40%                 ] report1.sqlite[2/7] [========41%                 ] report1.sqlite[2/7] [========42%                 ] report1.sqlite[2/7] [=========43%                ] report1.sqlite[2/7] [=========44%                ] report1.sqlite[2/7] [=========45%                ] report1.sqlite[2/7] [=========46%                ] report1.sqlite[2/7] [==========47%               ] report1.sqlite[2/7] [==========48%               ] report1.sqlite[2/7] [==========49%               ] report1.sqlite[2/7] [===========50%              ] report1.sqlite[2/7] [===========51%              ] report1.sqlite[2/7] [===========52%              ] report1.sqlite[2/7] [===========53%              ] report1.sqlite[2/7] [============54%             ] report1.sqlite[2/7] [============55%             ] report1.sqlite[2/7] [============56%             ] report1.sqlite[2/7] [============57%             ] report1.sqlite[2/7] [=============58%            ] report1.sqlite[2/7] [=============59%            ] report1.sqlite[2/7] [=============60%            ] report1.sqlite[2/7] [==============61%           ] report1.sqlite[2/7] [==============62%           ] report1.sqlite[2/7] [==============63%           ] report1.sqlite[2/7] [==============64%           ] report1.sqlite[2/7] [===============65%          ] report1.sqlite[2/7] [===============66%          ] report1.sqlite[2/7] [===============67%          ] report1.sqlite[2/7] [================68%         ] report1.sqlite[2/7] [================69%         ] report1.sqlite[2/7] [================70%         ] report1.sqlite[2/7] [================71%         ] report1.sqlite[2/7] [=================72%        ] report1.sqlite[2/7] [=================73%        ] report1.sqlite[2/7] [=================74%        ] report1.sqlite[2/7] [==================75%       ] report1.sqlite[2/7] [==================76%       ] report1.sqlite[2/7] [==================77%       ] report1.sqlite[2/7] [==================78%       ] report1.sqlite[2/7] [===================79%      ] report1.sqlite[2/7] [===================80%      ] report1.sqlite[2/7] [===================81%      ] report1.sqlite[2/7] [===================82%      ] report1.sqlite[2/7] [====================83%     ] report1.sqlite[2/7] [====================84%     ] report1.sqlite[2/7] [====================85%     ] report1.sqlite[2/7] [=====================86%    ] report1.sqlite[2/7] [=====================87%    ] report1.sqlite[2/7] [=====================88%    ] report1.sqlite[2/7] [=====================89%    ] report1.sqlite[2/7] [======================90%   ] report1.sqlite[2/7] [======================91%   ] report1.sqlite[2/7] [======================92%   ] report1.sqlite[2/7] [=======================93%  ] report1.sqlite[2/7] [=======================94%  ] report1.sqlite[2/7] [=======================95%  ] report1.sqlite[2/7] [=======================96%  ] report1.sqlite[2/7] [========================97% ] report1.sqlite[2/7] [========================98% ] report1.sqlite[2/7] [========================99% ] report1.sqlite[2/7] [========================100%] report1.sqlite[2/7] [========================100%] report1.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances    Avg (ns)       Med (ns)      Min (ns)     Max (ns)    StdDev (ns)   Style                                 Range                               
 --------  ---------------  ---------  -------------  -------------  -----------  -----------  -----------  -------  ------------------------------------------------------------------
     31.9      19551879683          1  19551879683.0  19551879683.0  19551879683  19551879683          0.0  PushPop  nvFuser::Manager::CudaFuseGraph                                   
      7.8       4803809456      26800       179246.6        26261.0        18106    317418415    6006727.9  PushPop  nvFuser::Manager::runCudaFusionGroup                              
      7.8       4756996765      26800       177499.9        24564.5        17018    317413281    6006656.8  PushPop  GraphCache::runGraphWithInputs                                    
      7.7       4719041494      26800       176083.6        23207.0        15984    317409316    6006597.9  PushPop  FusionExecutorCache::runFusionWithInputs                          
      7.2       4401600206      26800       164238.8        17591.0        12115    305481323    5772134.4  PushPop  FusionKernelRuntime::runWithInput                                 
      7.0       4277130936      26800       159594.4        12926.0         9658    305471034    5772042.5  PushPop  FusionKernelRuntime::runKernelWithInput                           
      6.4       3910977385         18    217276521.4    194640983.5    124546030    304551476   47971116.4  PushPop  FusionKernelRuntime::runKernelWithInput::Compile                  
      5.8       3537448814         18    196524934.1    175706803.5    124499662    273465254   39631286.8  PushPop  compileFusion                                                     
      4.6       2811127963         18    156173775.7    146776742.0    123629240    204909255   21955616.7  PushPop  executor_utils::NVRTC                                             
      4.6       2807045851         18    155946991.7    146517149.0    123389578    204680903   21957511.3  PushPop  executor_utils::Nvrtc::CompileProgram                             
      2.1       1286576155       2438       527717.9          423.0           94    563722228   11680574.3  PushPop  compileFusionRecursive                                            
      1.2        707304958         18     39294719.9     30793617.5       715648     67826719   19450424.3  PushPop  GpuLower::lower                                                   
      0.9        562109510        144      3903538.3      1691184.5       707538    109009077    9237540.5  PushPop  nvFuser::Manager::compileCudaFusionGroup                          
      0.8        461663944         18     25647996.9     19932035.5       226392     44724520   12900591.0  PushPop  GpuLower::Lower::IndexLowering::getIndexedExprs                   
      0.6        366367234         17     21551013.8     17439119.0     13340448     34944245    7801660.6  PushPop  Schedule PointWise Fusion                                         
      0.5        327356817      26800        12214.8        11511.0         8620       916703      15085.3  PushPop  FusionExecutor::RunFusion                                         
      0.5        286664341        960       298608.7       322112.0        23566       448827      84885.9  PushPop  GpuLower::Lower::Index::getProducerStridedIndices                 
      0.3        167735140        967       173459.3       181809.0        18999       289214      45006.3  PushPop  GpuLower::Lower::Index::getConsumerStridedIndices                 
      0.3        154605537         18      8589196.5      9773087.5       204845     12059983    3479887.2  PushPop  FusionKernelRuntime::FusionKernelRuntime                          
      0.2        146264146        540       270859.5        24233.0         4763      4122428     496097.5  PushPop  GpuLower::Lower::UnswitchPredicate::openLoop                      
      0.2        144017008       3720        38714.2        40455.0        10080        81706      10046.9  PushPop  transform_replay.cpp::getMatchedLeafPosWithoutReplayCasP          
      0.2        119424367      26800         4456.1         4309.0         3444       167258       1957.9  PushPop  ExecutorRunFusion::cuLaunchKernel                                 
      0.2        116117161      26800         4332.7         3897.0         2444        38446       1650.9  PushPop  FusionExecutorCache::prepareInputs                                
      0.2         93022542      26782         3473.3         3179.0         2056        46276       1103.8  PushPop  ExecutorRunFusion::OutputAlloc                                    
      0.1         82836441         18      4602024.5      3741445.0        48103      8531399    2497145.8  PushPop  ConditionalFromPredicateModifier::ConditionalFromPredicateModifier
      0.1         78730980       1423        55327.5        62785.0         6617       141438      19552.5  PushPop  TransformReplay::replayPasC                                       
      0.1         74626930        287       260024.1       250512.0        14669       510458     113565.1  PushPop  GpuLower::Lower::Index::getReferenceRootPredicates                
      0.1         58844545         81       726475.9       381918.0         7448      4124937    1054086.5  PushPop  GpuLower::Lower::UnswitchPredicate::get                           
      0.1         58177596        525       110814.5         5509.0         3645       538238     165334.0  PushPop  GpuLower::Lower::UnswitchPredicate::predicateOn                   
      0.1         52969448       2381        22246.7        24925.0         2608        71178      11045.8  PushPop  GpuLower::Lower::updateIndexCompute                               
      0.1         46285739         34      1361345.3      1214948.0         5833      3461313    1269773.5  PushPop  getPointwiseHeuristics                                            
      0.1         45759888        215       212836.7       196452.0        23263       411016      91197.7  PushPop  GpuLower::Lower::getGlobalProducerIndex                           
      0.0         28284942        926        30545.3        28716.5         7116       103850      12670.3  PushPop  transform_replay.cpp::getMatchedLeafPosWithoutReplayPasC          
      0.0         26872425      15798         1701.0          606.0          107        33189       2886.8  PushPop  isFusibleCudaFusionGroup                                          
      0.0         23354686        435        53688.9         4444.0         2237       326389      89712.8  PushPop  GpuLower::Lower::getInlinePredicate                               
      0.0         20495317       1736        11806.1         7299.0          721       397602      13907.7  PushPop  Fusion::resetTvUses                                               
      0.0         19223063         18      1067947.9       880119.5        33234      1761149     480190.1  PushPop  GpuLower::Lower::replaceSymbolicSizes                             
      0.0         18801058         36       522251.6       286121.5        17988      1438032     453277.7  PushPop  Fusion copy                                                       
      0.0         17204684        130       132343.7        47355.5          611       935406     202908.4  PushPop  Fusion clear                                                      
      0.0         17181991        296        58047.3          652.0           99       934380     148922.1  PushPop  IrContainer clear                                                 
      0.0         14053542         18       780752.3       637929.0        27308      1591320     418823.8  PushPop  generateCudaKernel                                                
      0.0         10388651         47       221035.1       214021.0        18034       288421      44884.3  PushPop  GpuLower::Lower::getGlobalConsumerIndex                           
      0.0          9167046         18       509280.3       454360.0        86697       873737     193072.8  PushPop  ExecutorRunFusion::ValidateAndInitialize                          
      0.0          9151953         36       254220.9       217140.5        10861       555000     144966.3  PushPop  IrContainer copy                                                  
      0.0          7311391         29       252116.9       352734.0         7631       459675     181760.2  PushPop  GpuLower::Lower::UnswitchPredicate::openIte                       
      0.0          6400294      26782          239.0          213.0          100        10700        186.1  PushPop  ExecutorRunFusion::IntermediateBufferAlloc                        
      0.0          6293995       8811          714.3          394.0           87        16913        889.7  PushPop  kir::ExpressionEvaluator::evaluate                                
      0.0          5185591         18       288088.4       193542.5         5199       777687     182640.9  PushPop  GpuLower::Lower::insertAllocations                                
      0.0          4058801         18       225488.9       174017.0        15495       362774     101630.6  PushPop  GpuLower::Lower::validateIr                                       
      0.0          3566094         18       198116.3       157351.5        21401       374985      91073.4  PushPop  GpuLower::Lower::LoopNestGenerator::loweredExprs                  
      0.0          3513018         22       159682.6       136311.0        39865       290209      85620.2  PushPop  GraphCache::GraphCache                                            
      0.0          3487643         22       158529.2       134918.0        38560       288980      85587.6  PushPop  GraphCache::createFusion                                          
      0.0          3467542         22       157615.5       133845.0        37310       288182      85612.0  PushPop  parseJitIR                                                        
      0.0          3416874         18       189826.3       152133.0         9136       304220      83751.1  PushPop  GpuLower::Lower::validateIterDomainUse                            
      0.0          3315754         18       184208.6       150676.5        12270       295488      80456.8  PushPop  GpuLower::Lower::validatePartialSplit                             
      0.0          2998476         18       166582.0       140263.0         7990       244670      62701.4  PushPop  GpuLower::Lower::UnrollPass::runPass                              
      0.0          2887052         18       160391.8       126994.5        27660       260920      64645.3  PushPop  GpuLower::Lower::ThreadPredicateMap                               
      0.0          2746896         18       152605.3       148315.5       143452       166400       7937.6  PushPop  executor_utils::Nvrtc::LoadPTX                                    
      0.0          2471288       1209         2044.1          350.0          102       927870      26905.0  PushPop  PeepholeOptimizeShapeExpressions                                  
      0.0          2460122       6427          382.8          287.0          120         6231        310.3  PushPop  GpuLower::Lower::IndexCompute::IndexCompute                       
      0.0          2044954         18       113608.6        97526.0        11791       199368      46127.8  PushPop  reuseMemoryAllocations                                            
      0.0          1974740         54        36569.3        22403.5        11350        74728      21661.5  PushPop  TransformReplay::replayCasP                                       
      0.0          1635328       2616          625.1          193.0           79        40833       2718.1  PushPop  getTerminatingOutputs                                             
      0.0          1541874         36        42829.8        31266.0         7085       132449      31261.4  PushPop  FusionExecutor::ComputeLaunchParams                               
      0.0          1537170         18        85398.3        73557.5         3773       176043      42493.6  PushPop  GpuLower::Lower::insertMagicZero                                  
      0.0          1427139         18        79285.5        71709.5         4269       126741      31741.1  PushPop  GpuLower::Lower::validateParallelize                              
      0.0           884712         18        49150.7        49477.5         6449        65625      14830.2  PushPop  GpuLower::Lower::validateVectorize                                
      0.0           617039        144         4285.0         2424.5         1462        13969       3105.5  PushPop  TypePropagate                                                     
      0.0           523871         18        29103.9        26347.5        18534        68838      12531.6  PushPop  executor_utils::NvrtcCreateProgram                                
      0.0           511553         18        28419.6        27667.5        24018        33197       2906.6  PushPop  FusionExecutor::AllocOutputs                                      
      0.0           466462         25        18658.5        23785.0         3037        26671       9715.9  PushPop  inferAndAlloc                                                     
      0.0           456452        395         1155.6         1090.0          538         5156        465.2  PushPop  GpuLower::Lower::ThreadPredicateMap::updateBitSet                 
      0.0           357278        102         3502.7         1583.5          922        37567       4770.7  PushPop  FusionExecutor::ParallelBindingResolution                         
      0.0           339772         18        18876.2        16349.0         3628        29695       7043.5  PushPop  Kernel::analyze                                                   
      0.0           324005         18        18000.3        16074.5         4134        24857       5387.0  PushPop  GpuLower::Lower::insertRawThreadSynchronization                   
      0.0           214994         18        11944.1        11373.5         9821        16411       1770.4  PushPop  executor_utils::ValidateKernelInputs                              
      0.0           211150         18        11730.6        10649.0         2573        16675       3666.9  PushPop  GpuLower::Lower::processMisalignedVectorization                   
      0.0           199911         18        11106.2         9982.0         1789        15862       3703.3  PushPop  GpuLower::Lower::MisalignedVectorizationModifier                  
      0.0           152294         36         4230.4         1627.0          647        49466       8372.2  PushPop  PrecomputedValues::Evaluate                                       
      0.0           147026         18         8168.1         7488.0         1613        16119       3248.8  PushPop  executor_utils::BindKernelInputs                                  
      0.0           145668         36         4046.3         4051.0          613         8118       1298.1  PushPop  executor_utils::BindFusionInputs                                  
      0.0           126540         18         7030.0         6450.0         4435        13490       1966.1  PushPop  executor_utils::Nvrtc::GetPTX                                     
      0.0           104020         18         5778.9         5263.0         1583         7389       1508.6  PushPop  GpuLower::Lower::insertWarThreadSynchronization                   
      0.0            65322         18         3629.0         3351.5         1961         6185       1551.2  PushPop  FusionExecutor::validateVectorizedTensors                         
      0.0            35062         18         1947.9         1833.0         1600         2822        323.7  PushPop  executor_utils::NvrtcDestroyProgram                               
      0.0            27216         18         1512.0         1337.0         1106         3026        467.4  PushPop  ExecutorRunFusion::FillCacheEntry                                 
      0.0            25786         18         1432.6         1468.0         1073         1743        190.8  PushPop  Segmenter::FusionSegmentGuard                                     
      0.0            21385         18         1188.1         1125.5          659         1818        253.2  PushPop  ~Segmenter::FusionSegmentGuard                                    
      0.0            15052         36          418.1          364.5          138         1504        276.2  PushPop  PrecomputedValuess::Validate                                      
      0.0             7045         36          195.7          138.0          100          446        112.5  PushPop  computeSharedMemory                                               
      0.0             6265         18          348.1          326.5          132          872        199.1  PushPop  FusionExecutor::AllocGlobalVals                                   

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)   Min (ns)   Max (ns)   StdDev (ns)                      Name                     
 --------  ---------------  ---------  -----------  ----------  --------  ----------  -----------  ---------------------------------------------
     46.0       1884141339      70909      26571.3      3941.0      2474  1285761301    4828712.6  cudaMemcpyAsync                              
     21.7        889239661          4  222309915.3  47917257.5      1215   793403931  383400078.6  cudaFree                                     
     17.8        728714414     198736       3666.7      3507.0      2474     2169733       5069.7  cudaLaunchKernel                             
      3.8        156273910       1095     142715.9     34285.0      2756    12494763     659929.8  cuModuleUnload                               
      3.3        135741067         16    8483816.7      1227.5      1038   135607972   33899786.7  cudaStreamCreateWithFlags                    
      2.5        101168883      26800       3775.0      3643.0      2961      166469       1918.2  cuLaunchKernel                               
      1.5         60402235      29886       2021.1       470.0       280    46191789     267193.9  cudaStreamIsCapturing_v10000                 
      0.9         38532520      13498       2854.7      1857.0       718       92199       9556.4  cudaStreamSynchronize                        
      0.9         36976876      29818       1240.1      1214.0       655       98321       1024.7  cudaEventRecord                              
      0.6         23038932       5176       4451.1      4919.0       227       21867       1423.5  cudaMemsetAsync                              
      0.4         17072109       4221       4044.6      3906.0      3404       19877        666.2  cudaLaunchKernelExC_v11060                   
      0.2          7560047         75     100800.6     93521.0      3425      372690      48906.6  cudaMalloc                                   
      0.2          7542595          1    7542595.0   7542595.0   7542595     7542595          0.0  cudaProfilerStop                             
      0.1          2548524         18     141584.7    140134.5    136643      150971       4412.4  cuModuleLoadDataEx                           
      0.0          1325753        400       3314.4      4087.5      1022       13141       2304.2  cudaDeviceSynchronize                        
      0.0           586887          1     586887.0    586887.0    586887      586887          0.0  cudaHostAlloc                                
      0.0           426846       2304        185.3       148.0        92        2599        110.8  cuGetProcAddress                             
      0.0           183581          1     183581.0    183581.0    183581      183581          0.0  cudaProfilerStart                            
      0.0            40259         47        856.6       602.0       297       10024       1407.9  cudaOccupancyMaxActiveBlocksPerMultiprocessor
      0.0            23613         37        638.2       371.0       316        5841        973.9  cudaEventCreateWithFlags                     
      0.0            10894          6       1815.7      1869.5      1210        2417        505.6  cuInit                                       
      0.0             3141          7        448.7       231.0       204        1575        501.8  cuModuleGetLoadingMode                       

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     51.0        464570109       6633   70039.2   38336.0     10272    323587      83730.0  void at::native::<unnamed>::avg_pool2d_out_cuda_frame<float, float>(int, const T1 *, long, long, loâ€¦
      8.5         77811354      56300    1382.1    1376.0      1183      3392         54.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl<at::native::â€¦
      4.4         40485864       3618   11190.1   10880.0     10720     14144        923.3  sm86_xmma_fprop_implicit_gemm_indexed_tf32f32_tf32f32_f32_nhwckrsc_nchw_tilesize64x32x64_stage4_warâ€¦
      3.3         29714825       8442    3519.9    2272.0      1503     15552       2808.1  void cudnn::ops::nchwToNhwcKernel<float, float, float, (bool)0, (bool)1, (cudnnKernelDataType_t)2>(â€¦
      3.1         28467801      27584    1032.0     992.0       959      2912         76.0  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctor_add<float>, at::detaâ€¦
      2.4         22113323      12864    1719.0    1696.0      1503      2240        175.4  std::enable_if<!T7, void>::type internal::gemvx::kernel<int, int, float, float, float, float, (boolâ€¦
      2.3         20560040       3618    5682.7    5569.0      5152      7873        466.7  void cutlass::Kernel<cutlass_80_tensorop_s1688gemm_64x64_32x6_nn_align4>(T1::Params)                
      1.8         16774006      19298     869.2     864.0       831      1024         17.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::FillFunctor<float>, at::detail::â€¦
      1.8         16309899       3015    5409.6    5376.0      5279      6112         94.8  void cutlass::Kernel<cutlass_80_tensorop_s1688gemm_64x128_32x3_nn_align4>(T1::Params)               
      1.7         15157166        402   37704.4   37424.5     31457     47968       5869.7  void precomputed_convolve_sgemm<float, (int)1024, (int)5, (int)5, (int)4, (int)3, (int)3, (int)1, (â€¦
      1.4         12905279       6633    1945.6    1601.0      1471     13120       1859.0  std::enable_if<!T7, void>::type internal::gemvx::kernel<int, int, float, float, float, float, (boolâ€¦
      1.4         12718302       6432    1977.3    2048.0      1696      2144        138.5  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<float, at::native::func_wrappâ€¦
      1.1         10329470        402   25695.2   25664.0     20576     31008       4622.6  void implicit_convolve_sgemm<float, float, (int)1024, (int)5, (int)5, (int)3, (int)3, (int)3, (int)â€¦
      1.0          9227355       6400    1441.8    1440.0      1376      1568         16.9  CudaCodeGen::kernel4(CudaCodeGen::Tensor<float, (int)3>, CudaCodeGen::Tensor<float, (int)3>, CudaCoâ€¦
      1.0          8685042       6200    1400.8    1376.0      1312      1632         45.9  CudaCodeGen::kernel12(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)1>, CudaCâ€¦
      0.8          7730865       5025    1538.5    1504.0      1409      2016         98.6  void dot_kernel<float, (int)128, (int)0, cublasDotParams<cublasGemvTensorStridedBatched<const floatâ€¦
      0.8          7510561       3000    2503.5    2496.0      2367      2688         40.9  CudaCodeGen::kernel14(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)4>, CudaCâ€¦
      0.8          7474590       6528    1145.0    1152.0      1056      1376         21.5  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sigmoid_kernel_cuda(at::TensorItâ€¦
      0.8          7187829       3147    2284.0    1823.0      1663      6688        838.0  void at::native::reduce_kernel<(int)512, (int)1, at::native::ReduceOp<bool, at::native::func_wrappeâ€¦
      0.8          7041240       6400    1100.2    1088.0      1023      1344         54.6  CudaCodeGen::kernel5(CudaCodeGen::Tensor<float, (int)1>, CudaCodeGen::Tensor<float, (int)1>, CudaCoâ€¦
      0.8          6922788       6432    1076.3    1088.0      1024      1121         18.1  void at::native::vectorized_elementwise_kernel<(int)4, void at::native::compare_scalar_kernel<floatâ€¦
      0.7          6772039       4020    1684.6    1696.0      1311      1889         89.6  void splitKreduce_kernel<(int)32, (int)16, int, float, float, float, float, (bool)1, (bool)0, (boolâ€¦
      0.7          6673474        402   16600.7   16544.0     14816     18656       1623.5  void implicit_convolve_sgemm<float, float, (int)128, (int)5, (int)5, (int)3, (int)3, (int)3, (int)1â€¦
      0.7          6638747       5025    1321.1    1312.0      1279      1408         23.1  void reduce_1Block_kernel<float, (int)128, (int)7, cublasGemvTensorStridedBatched<float>, cublasGemâ€¦
      0.7          6471628        603   10732.4   10720.0     10560     10977         74.9  sm86_xmma_fprop_implicit_gemm_indexed_tf32f32_tf32f32_f32_nhwckrsc_nchw_tilesize64x64x64_stage3_warâ€¦
      0.6          5860317       1005    5831.2    4928.0      4704      7968       1216.3  void cutlass::Kernel<cutlass_80_tensorop_s1688gemm_128x64_16x6_nn_align4>(T1::Params)               
      0.5          4572360        402   11374.0   11360.0     11168     11712         96.1  void cutlass::Kernel<cutlass_80_tensorop_s1688gemm_64x64_32x6_nn_align1>(T1::Params)                
      0.5          4217864        402   10492.2   10496.0     10336     10688         84.9  cudnn_ampere_scudnn_winograd_128x128_ldg1_ldg4_relu_tile148n_nt_v1                                  
      0.4          4044680       3147    1285.2    1024.0       960     22592        787.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, boolâ€¦
      0.4          3847264       1477    2604.8    2528.0      1760      5312        297.5  void cudnn::bn_fw_inf_1C11_kernel_NCHW<float, float, (bool)1, (int)1>(T2, T2, cudnnTensorStruct, coâ€¦
      0.4          3516963       1407    2499.6    2816.0      1888      3232        460.1  void gemv2T_kernel_val<int, int, float, float, float, float, (int)128, (int)16, (int)2, (int)2, (boâ€¦
      0.4          3401630        201   16923.5   16928.0     16416     17408        182.6  cudnn_ampere_scudnn_128x64_relu_xregs_large_nn_v1                                                   
      0.4          3325782        603    5515.4    5536.0      5184      5856        172.3  void cutlass::Kernel<cutlass_80_tensorop_s1688gemm_256x64_16x4_nn_align4>(T1::Params)               
      0.4          3206344       3216     997.0     992.0       959      1025         13.2  void at::native::unrolled_elementwise_kernel<at::native::CUDAFunctor_add<float>, at::detail::Array<â€¦
      0.3          2305149        603    3822.8    4096.0      3136      4385        448.7  void cutlass::Kernel<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align4>(T1::Params)                
      0.2          1728731       1672    1033.9    1024.0       959      1057         16.5  void at::native::vectorized_elementwise_kernel<(int)2, at::native::CUDAFunctor_add<float>, at::detaâ€¦
      0.2          1698697        201    8451.2    8448.0      8192      8736        120.4  void cutlass::Kernel<cutlass_80_tensorop_s1688gemm_64x64_16x6_nn_align1>(T1::Params)                
      0.2          1469134        800    1836.4    1824.0      1728      2016         40.6  CudaCodeGen::kernel2(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)1>, CudaCoâ€¦
      0.2          1420394       1000    1420.4    1408.0      1344      1632         44.4  CudaCodeGen::kernel8(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)1>, CudaCoâ€¦
      0.1          1188650        400    2971.6    2944.0      2815      3201         90.7  CudaCodeGen::kernel10(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)4>, CudaCâ€¦
      0.1           985309        600    1642.2    1664.0      1472      1824         75.6  CudaCodeGen::kernel16(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)1>, CudaCâ€¦
      0.1           916462        200    4582.3    4576.0      4448      4864         68.3  CudaCodeGen::kernel6(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)4>, CudaCoâ€¦
      0.1           817575        201    4067.5    4064.0      4000      4225         31.4  void at::native::<unnamed>::max_pool_forward_nchw<float, float>(int, const T1 *, long, long, long, â€¦
      0.1           660777        402    1643.7    1632.0      1600      1824         46.2  void cudnn::winograd::generateWinogradTilesKernel<(int)0, float, float>(cudnn::winograd::GenerateWiâ€¦
      0.1           645091        200    3225.5    3232.0      3104      3424         54.8  CudaCodeGen::kernel3(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)4>, CudaCoâ€¦
      0.1           614086        200    3070.4    3072.0      2976      3168         37.9  CudaCodeGen::kernel9(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)4>, CudaCoâ€¦
      0.1           601265        200    3006.3    3008.0      2816      3169         70.1  CudaCodeGen::kernel1(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)1>, CudaCoâ€¦
      0.1           584773        402    1454.7    1441.0      1407      1473         17.9  void cudnn::cnn::kern_precompute_indices<(bool)0>(int *, int, int, int, int, int)                   
      0.1           503498        200    2517.5    2528.0      2400      2624         40.2  CudaCodeGen::kernel13(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)4>, CudaCâ€¦
      0.0           429155        200    2145.8    2144.0      2016      2272         49.0  CudaCodeGen::kernel7(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)1>, CudaCoâ€¦
      0.0           411777        200    2058.9    2048.0      2016      2176         28.8  CudaCodeGen::kernel18(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)4>, CudaCâ€¦
      0.0           388963        200    1944.8    1952.0      1888      1985         19.1  CudaCodeGen::kernel17(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)4>, CudaCâ€¦
      0.0           320035        200    1600.2    1600.0      1536      1728         35.1  CudaCodeGen::kernel11(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)1>, CudaCâ€¦
      0.0           296771        200    1483.9    1472.0      1439      1568         25.7  CudaCodeGen::kernel15(CudaCodeGen::Tensor<float, (int)4>, CudaCodeGen::Tensor<float, (int)1>, CudaCâ€¦
      0.0           289768        201    1441.6    1440.0      1407      1568         32.0  void cublasLt::epilogue::impl::globalKernel<(int)8, (int)32, float, float, float, (bool)1, (bool)1>â€¦
      0.0           259107        201    1289.1    1280.0      1279      1313         14.5  void cask_cudnn::computeOffsetsKernel<(bool)0, (bool)0>(cask_cudnn::ComputeOffsetsParams)           
      0.0           206947        203    1019.4    1024.0       960      1152         22.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floaâ€¦
      0.0           132804        130    1021.6    1024.0       959      1248         33.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::CUDAFunctorOnSelf_add<float>, atâ€¦
      0.0           118656        107    1108.9    1120.0      1055      1152         28.2  void at::native::vectorized_elementwise_kernel<(int)4, at::native::BinaryFunctor<float, float, floaâ€¦
      0.0           115753        107    1081.8    1088.0      1024      1121         19.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::sqrt_kernel_cuda(at::TensorIteraâ€¦
      0.0            89282         70    1275.5    1168.0      1088      2528        286.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::<unnamed>::launch_clamp_scalar(aâ€¦
      0.0            73217         64    1144.0    1120.0      1089      1312         35.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::tanh_kernel_cuda(at::TensorIteraâ€¦
      0.0            34238         32    1069.9    1056.0      1024      1089         18.1  void at::native::vectorized_elementwise_kernel<(int)4, at::native::<unnamed>::where_kernel_impl(at:â€¦
      0.0            33217         32    1038.0    1056.0       992      1056         22.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::<unnamed>::CompareFunctor<float>â€¦
      0.0            30594         22    1390.6    1280.0      1152      2496        290.9  void at::native::vectorized_elementwise_kernel<(int)4, at::native::AUnaryFunctor<float, float, floaâ€¦
      0.0            22046         22    1002.1     992.0       991      1120         28.6  void at::native::vectorized_elementwise_kernel<(int)4, at::native::neg_kernel_cuda(at::TensorIteratâ€¦
      0.0             3296          2    1648.0    1648.0      1472      1824        248.9  void at::native::elementwise_kernel<(int)128, (int)2, void at::native::gpu_kernel_impl<at::native::â€¦

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  --------  --------  --------  --------  -----------  ------------------------------
     57.1        122890091  12095   10160.4     864.0       831   3385857      85024.4  [CUDA memcpy Device-to-Host]  
     26.7         57445154  57411    1000.6     992.0       927     19680        277.0  [CUDA memcpy Device-to-Device]
     15.4         33064939   1403   23567.3     416.0       351   1006922      91112.1  [CUDA memcpy Host-to-Device]  
      0.9          1976972   4975     397.4     384.0       351      1504         62.5  [CUDA memset]                 

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
   1079.324  12095     0.089     0.000     0.000     9.437        0.576  [CUDA memcpy Device-to-Host]  
    553.742  57411     0.010     0.002     0.000     9.437        0.159  [CUDA memcpy Device-to-Device]
    360.454   1403     0.257     0.001     0.000     9.437        0.952  [CUDA memcpy Host-to-Device]  
      1.056   4975     0.000     0.000     0.000     0.027        0.000  [CUDA memset]                 

Generated:
    /root/mlir/baseline/skipnet/report1.nsys-rep
    /root/mlir/baseline/skipnet/report1.sqlite
