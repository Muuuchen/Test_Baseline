WARNING: python3 and any of its children processes will be profiled.

---batch_size=1--jit=True--while=True---
[31m100 iters, min = 0.6256 ms, max = 0.6931 ms, avg = 0.6549 ms[m
Generating '/tmp/nsys-report-5120.qdstrm'
[1/7] [0%                          ] report1.nsys-rep[1/7] [0%                          ] report1.nsys-rep[1/7] [8%                          ] report1.nsys-rep[1/7] [7%                          ] report1.nsys-rep[1/7] [=15%                        ] report1.nsys-rep[1/7] [13%                         ] report1.nsys-rep[1/7] [12%                         ] report1.nsys-rep[1/7] [=17%                        ] report1.nsys-rep[1/7] [==19%                       ] report1.nsys-rep[1/7] [==21%                       ] report1.nsys-rep[1/7] [===22%                      ] report1.nsys-rep[1/7] [======33%                   ] report1.nsys-rep[1/7] [=========46%                ] report1.nsys-rep[1/7] [=============58%            ] report1.nsys-rep[1/7] [================70%         ] report1.nsys-rep[1/7] [==================78%       ] report1.nsys-rep[1/7] [====================85%     ] report1.nsys-rep[1/7] [========================100%] report1.nsys-rep[1/7] [========================100%] report1.nsys-rep
[2/7] [0%                          ] report1.sqlite[2/7] [1%                          ] report1.sqlite[2/7] [2%                          ] report1.sqlite[2/7] [3%                          ] report1.sqlite[2/7] [4%                          ] report1.sqlite[2/7] [5%                          ] report1.sqlite[2/7] [6%                          ] report1.sqlite[2/7] [7%                          ] report1.sqlite[2/7] [8%                          ] report1.sqlite[2/7] [9%                          ] report1.sqlite[2/7] [10%                         ] report1.sqlite[2/7] [11%                         ] report1.sqlite[2/7] [12%                         ] report1.sqlite[2/7] [13%                         ] report1.sqlite[2/7] [14%                         ] report1.sqlite[2/7] [=15%                        ] report1.sqlite[2/7] [=16%                        ] report1.sqlite[2/7] [=17%                        ] report1.sqlite[2/7] [==18%                       ] report1.sqlite[2/7] [==19%                       ] report1.sqlite[2/7] [==20%                       ] report1.sqlite[2/7] [==21%                       ] report1.sqlite[2/7] [===22%                      ] report1.sqlite[2/7] [===23%                      ] report1.sqlite[2/7] [===24%                      ] report1.sqlite[2/7] [====25%                     ] report1.sqlite[2/7] [====26%                     ] report1.sqlite[2/7] [====27%                     ] report1.sqlite[2/7] [====28%                     ] report1.sqlite[2/7] [=====29%                    ] report1.sqlite[2/7] [=====30%                    ] report1.sqlite[2/7] [=====31%                    ] report1.sqlite[2/7] [=====32%                    ] report1.sqlite[2/7] [======33%                   ] report1.sqlite[2/7] [======34%                   ] report1.sqlite[2/7] [======35%                   ] report1.sqlite[2/7] [=======36%                  ] report1.sqlite[2/7] [=======37%                  ] report1.sqlite[2/7] [=======38%                  ] report1.sqlite[2/7] [=======39%                  ] report1.sqlite[2/7] [========40%                 ] report1.sqlite[2/7] [========41%                 ] report1.sqlite[2/7] [========42%                 ] report1.sqlite[2/7] [=========43%                ] report1.sqlite[2/7] [=========44%                ] report1.sqlite[2/7] [=========45%                ] report1.sqlite[2/7] [=========46%                ] report1.sqlite[2/7] [==========47%               ] report1.sqlite[2/7] [==========48%               ] report1.sqlite[2/7] [==========49%               ] report1.sqlite[2/7] [===========50%              ] report1.sqlite[2/7] [===========51%              ] report1.sqlite[2/7] [===========52%              ] report1.sqlite[2/7] [===========53%              ] report1.sqlite[2/7] [============54%             ] report1.sqlite[2/7] [============55%             ] report1.sqlite[2/7] [============56%             ] report1.sqlite[2/7] [============57%             ] report1.sqlite[2/7] [=============58%            ] report1.sqlite[2/7] [=============59%            ] report1.sqlite[2/7] [=============60%            ] report1.sqlite[2/7] [==============61%           ] report1.sqlite[2/7] [==============62%           ] report1.sqlite[2/7] [==============63%           ] report1.sqlite[2/7] [==============64%           ] report1.sqlite[2/7] [===============65%          ] report1.sqlite[2/7] [===============66%          ] report1.sqlite[2/7] [===============67%          ] report1.sqlite[2/7] [================68%         ] report1.sqlite[2/7] [================69%         ] report1.sqlite[2/7] [================70%         ] report1.sqlite[2/7] [================71%         ] report1.sqlite[2/7] [=================72%        ] report1.sqlite[2/7] [=================73%        ] report1.sqlite[2/7] [=================74%        ] report1.sqlite[2/7] [==================75%       ] report1.sqlite[2/7] [==================76%       ] report1.sqlite[2/7] [==================77%       ] report1.sqlite[2/7] [==================78%       ] report1.sqlite[2/7] [===================79%      ] report1.sqlite[2/7] [===================80%      ] report1.sqlite[2/7] [===================81%      ] report1.sqlite[2/7] [===================82%      ] report1.sqlite[2/7] [====================83%     ] report1.sqlite[2/7] [====================84%     ] report1.sqlite[2/7] [====================85%     ] report1.sqlite[2/7] [=====================86%    ] report1.sqlite[2/7] [=====================87%    ] report1.sqlite[2/7] [=====================88%    ] report1.sqlite[2/7] [=====================89%    ] report1.sqlite[2/7] [======================90%   ] report1.sqlite[2/7] [======================91%   ] report1.sqlite[2/7] [======================92%   ] report1.sqlite[2/7] [=======================93%  ] report1.sqlite[2/7] [=======================94%  ] report1.sqlite[2/7] [=======================95%  ] report1.sqlite[2/7] [=======================96%  ] report1.sqlite[2/7] [========================97% ] report1.sqlite[2/7] [========================98% ] report1.sqlite[2/7] [========================99% ] report1.sqlite[2/7] [========================100%] report1.sqlite[2/7] [========================100%] report1.sqlite
[3/7] Executing 'nvtx_sum' stats report

 Time (%)  Total Time (ns)  Instances   Avg (ns)     Med (ns)    Min (ns)   Max (ns)   StdDev (ns)   Style                                    Range                                 
 --------  ---------------  ---------  -----------  -----------  ---------  ---------  -----------  -------  -----------------------------------------------------------------------
     31.6        210033171         14   15002369.4       6594.0       5432  209930616   56104208.8  PushPop  TSL:Thunk:#hlo_op=fusion#                                              
     31.6        210010097          1  210010097.0  210010097.0  210010097  210010097          0.0  PushPop  TSL:XlaModule:#hlo_module=jit__threefry_seed,program_id=0#             
     18.8        124818179        201     620986.0     618942.0     585092     810824      30218.8  PushPop  TSL:XlaModule:#hlo_module=jit__unnamed_wrapped_function_,program_id=23#
      7.3         48642450       2211      22000.2      25073.0       8894      38290       5123.8  PushPop  TSL:Thunk:#hlo_op=while.178#                                           
      1.3          8584400       2022       4245.5       4093.0       3880      14769        599.5  PushPop  TSL:Thunk:#hlo_op=fusion.5#                                            
      1.3          8351160       2211       3777.1       3680.0       3394      10671        344.4  PushPop  TSL:Thunk:#hlo_op=fusion.12#                                           
      1.2          8049941       2022       3981.2       3695.5       3432      63868       3002.1  PushPop  TSL:Thunk:#hlo_op=fusion.2#                                            
      1.2          7834893       2010       3898.0       3702.0       3443     181560       3977.6  PushPop  TSL:Thunk:#hlo_op=fusion.10#                                           
      1.2          7783641       2010       3872.5       3776.0       3501       9206        314.1  PushPop  TSL:Thunk:#hlo_op=fusion.8#                                            
      1.2          7689955       2011       3823.9       3703.0       3417      66576       1457.5  PushPop  TSL:Thunk:#hlo_op=fusion.4#                                            
      1.2          7682608       2011       3820.3       3725.0       3444      10956        379.9  PushPop  TSL:Thunk:#hlo_op=fusion.3#                                            
      1.1          7491989       2010       3727.4       3650.0       3377      12236        303.7  PushPop  TSL:Thunk:#hlo_op=add.57#                                              
      0.3          2083215        201      10364.3       9807.0       9056      63656       4031.1  PushPop  TSL:Thunk:#hlo_op=copy.19#                                             
      0.2          1154021        201       5741.4       5666.0       5264      11345        510.7  PushPop  TSL:Thunk:#hlo_op=copy.18#                                             
      0.2          1083991        201       5393.0       5136.0       4755      25905       1537.6  PushPop  TSL:Thunk:#hlo_op=broadcast.53#                                        
      0.2          1077871        201       5362.5       4178.0       3855     183001      12643.7  PushPop  TSL:Thunk:#hlo_op=copy_fusion#                                         
      0.1           607457          8      75932.1      66371.0      62307     133845      23775.4  PushPop  TSL:XlaModule:#hlo_module=jit__normal,program_id=6#                    
      0.0           217200         13      16707.7      12117.0      10228      33056       7053.7  PushPop  TSL:Thunk:#hlo_op=custom-call.1#                                       
      0.0           208641          2     104320.5     104320.5      70723     137918      47514.0  PushPop  TSL:XlaModule:#hlo_module=jit__normal,program_id=2#                    
      0.0           170285          1     170285.0     170285.0     170285     170285          0.0  PushPop  TSL:XlaModule:#hlo_module=jit__normal,program_id=14#                   
      0.0           143639          1     143639.0     143639.0     143639     143639          0.0  PushPop  TSL:XlaModule:#hlo_module=jit__normal,program_id=10#                   
      0.0           135045          1     135045.0     135045.0     135045     135045          0.0  PushPop  TSL:XlaModule:#hlo_module=jit__normal,program_id=19#                   
      0.0            14214          1      14214.0      14214.0      14214      14214          0.0  PushPop  TSL:Thunk:#hlo_op=fusion.1#                                            

[4/7] Executing 'cuda_api_sum' stats report

 Time (%)  Total Time (ns)  Num Calls   Avg (ns)     Med (ns)    Min (ns)  Max (ns)   StdDev (ns)               Name              
 --------  ---------------  ---------  -----------  -----------  --------  ---------  -----------  -------------------------------
     55.4        960260915          3  320086971.7  103845579.0      1397  856413939  467365879.6  cudaFree                       
     12.4        215742846      16724      12900.2        346.0       309  209824795    1622504.8  cudaStreamIsCapturing_v10000   
     11.9        205716017        705     291795.8      48947.0      1804   12894501     747577.9  cuModuleUnload                 
      9.1        158553431         16    9909589.4       1389.5       977  158134731   39526826.5  cudaStreamCreateWithFlags      
      2.9         49743518       2224      22366.7      23425.0      7000    1887972      57550.4  cuMemcpyDtoHAsync_v2           
      2.6         44779891          1   44779891.0   44779891.0  44779891   44779891          0.0  cudaProfilerStop               
      2.4         42388733          9    4709859.2      25538.0      3894   41319260   13729499.5  cuMemAlloc_v2                  
      2.3         39473884      16724       2360.3       2266.0      2031      31916        630.3  cuLaunchKernel                 
      0.2          3371908          7     481701.1     555184.0    233510     618118     161070.5  cuModuleLoadFatBinary          
      0.2          2845974      23081        123.3        116.0        98       5378        119.3  cuCtxSetCurrent                
      0.1          2022395        402       5030.8       5412.5      3176      22696       1821.7  cuMemcpyPeerAsync              
      0.1          1952145         13     150165.0      14906.0      2458     960941     277801.9  cuMemcpyHtoDAsync_v2           
      0.1          1311839       2219        591.2        424.0       393      88740       3338.6  cuStreamSynchronize            
      0.1          1110523        247       4496.0       2979.0      1067     275583      17396.5  cuLaunchHostFunc               
      0.0           705989          1     705989.0     705989.0    705989     705989          0.0  cuMemHostAlloc                 
      0.0           621288          1     621288.0     621288.0    621288     621288          0.0  cudaHostAlloc                  
      0.0           557822          4     139455.5     105089.5      3794     343849     159034.0  cudaMalloc                     
      0.0           498781         18      27710.1       7534.5      3151     277989      64480.6  cuStreamCreate                 
      0.0           438210          8      54776.3      19390.0      4109     154590      65408.4  cuMemFree_v2                   
      0.0           346634       1920        180.5        143.0        94       2416        108.7  cuGetProcAddress               
      0.0           300032        608        493.5        357.0       319      17443        811.7  cuEventQuery                   
      0.0           287689        471        610.8        566.0       269      11917        726.6  cuEventRecord                  
      0.0           229376        402        570.6        582.0       318       3550        238.0  cudaStreamGetCaptureInfo_v10010
      0.0           187014        256        730.5        508.0       428       9721        772.0  cuStreamWaitEvent              
      0.0           114675         51       2248.5       1263.0       315      20443       3522.7  cuEventCreate                  
      0.0           100215         13       7708.8       6520.0      5725      10992       2056.1  cudaLaunchKernel               
      0.0            46718          1      46718.0      46718.0     46718      46718          0.0  cuMemGetInfo_v2                
      0.0            25236          1      25236.0      25236.0     25236      25236          0.0  cudaMemsetAsync                
      0.0            16712          1      16712.0      16712.0     16712      16712          0.0  cudaProfilerStart              
      0.0            10343         19        544.4        341.0       317       2035        481.3  cudaEventCreateWithFlags       
      0.0             7067          5       1413.4       1284.0       808       2267        548.2  cuInit                         
      0.0             1521          5        304.2        259.0       213        519        122.2  cuModuleGetLoadingMode         

[5/7] Executing 'cuda_gpu_kern_sum' stats report

 Time (%)  Total Time (ns)  Instances  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)                                                  Name                                                
 --------  ---------------  ---------  --------  --------  --------  --------  -----------  ----------------------------------------------------------------------------------------------------
     28.7         20188298       2010   10043.9    9984.0      9856     10304        108.1  fusion_8                                                                                            
     21.1         14840639       2011    7379.7    7361.0      1120      7521        145.0  fusion_3                                                                                            
     18.6         13101422       2010    6518.1    6528.0      6495      6848         16.8  fusion_10                                                                                           
     18.3         12850737       2011    6390.2    6400.0       960      6560        130.3  fusion_4                                                                                            
      3.6          2532637       2211    1145.5    1152.0      1119      1185         13.7  fusion_12                                                                                           
      3.2          2239780       2022    1107.7    1120.0       960      2368         43.9  fusion_2                                                                                            
      2.9          2054165       2010    1022.0    1024.0       991      1057         12.4  add_57                                                                                              
      2.9          2028581       2022    1003.3     992.0       832      3072         68.7  fusion_5                                                                                            
      0.3           203107        201    1010.5    1024.0       991      1056         16.2  copy_fusion                                                                                         
      0.3           193093        201     960.7     960.0       928       993         12.8  broadcast_53                                                                                        
      0.0            22689         14    1620.6    1088.0      1056      3841        964.1  fusion                                                                                              
      0.0            21375         13    1644.2    1152.0      1120      3679        902.4  jax::cuda::<unnamed>::ThreeFry2x32Kernel(const unsigned int *, const unsigned int *, const unsignedâ€¦
      0.0              928          1     928.0     928.0       928       928          0.0  fusion_1                                                                                            

[6/7] Executing 'cuda_gpu_mem_time_sum' stats report

 Time (%)  Total Time (ns)  Count  Avg (ns)  Med (ns)  Min (ns)  Max (ns)  StdDev (ns)            Operation           
 --------  ---------------  -----  --------  --------  --------  --------  -----------  ------------------------------
     67.1          4299874   2224    1933.4     864.0       831   1129361      33038.1  [CUDA memcpy Device-to-Host]  
     26.7          1711544     13  131657.2    3360.0       416    887148     255292.5  [CUDA memcpy Host-to-Device]  
      6.2           396258    402     985.7     992.0       959      1504         30.6  [CUDA memcpy Device-to-Device]
      0.0             1568      1    1568.0    1568.0      1568      1568          0.0  [CUDA memset]                 

[7/7] Executing 'cuda_gpu_mem_size_sum' stats report

 Total (MB)  Count  Avg (MB)  Med (MB)  Min (MB)  Max (MB)  StdDev (MB)            Operation           
 ----------  -----  --------  --------  --------  --------  -----------  ------------------------------
     16.469     13     1.267     0.030     0.000     7.776        2.283  [CUDA memcpy Host-to-Device]  
      9.899   2224     0.004     0.000     0.000     3.888        0.121  [CUDA memcpy Device-to-Host]  
      0.027      1     0.027     0.027     0.027     0.027        0.000  [CUDA memset]                 
      0.003    402     0.000     0.000     0.000     0.000        0.000  [CUDA memcpy Device-to-Device]

Generated:
    /root/mlir/baseline/seq2seq/report1.nsys-rep
    /root/mlir/baseline/seq2seq/report1.sqlite
